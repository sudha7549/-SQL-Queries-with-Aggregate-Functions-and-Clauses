
             ------TO CREATE TABLE-------


CREATE TABLE customer(
            Cus_ID INT PRIMARY KEY,
            Cus_Name VARCHAR(100) NOT NULL,
            Ref_ID INT,
            Prod_ID INT NOT NULL,
            Date_of_purchase DATE,
            Price INT,
            Discount INT
);


INSERT INTO customer(Cus_ID, Cus_Name, Ref_ID, Prod_ID, Date_of_purchase, Price, Discount)
VALUES
    (1359, 'Elina Taylor', 1608, 20, TO_DATE('05-10-2006', 'DD-MM-YYYY'), 1000, 0),
    (1573, 'Mark Lyon', 1175, 40, TO_DATE('07-09-2008', 'DD-MM-YYYY'), 1550, 110),
    (1932, 'Stuart Twain', 1608, 60, TO_DATE('23-08-2009', 'DD-MM-YYYY'), 1550, 230),
    (1875, 'Allan Samueles', 1610, 80, TO_DATE('15-11-2011', 'DD-MM-YYYY'), 10000, 970),
    (1723, 'Peter Russel', 0, 40, TO_DATE('17-07-2010', 'DD-MM-YYYY'), 4000, 250),
    (1973, 'Andre Finch', 1932, 60, TO_DATE('12-03-2014', 'DD-MM-YYYY'), 6000, 530),
    (1205, 'Steffi Niculous', 1175, 20, TO_DATE('07-02-2012', 'DD-MM-YYYY'), 1500, 0),
    (1608, 'Adams Frankin', 0, 80, TO_DATE('05-01-2010', 'DD-MM-YYYY'), 8000, 509),
    (1175, 'Luke Martin', 1932, 60, TO_DATE('14-12-2007', 'DD-MM-YYYY'), 3500, 300),
    (1097, 'Joseph Milne', 1610, 40, TO_DATE('07-04-2007', 'DD-MM-YYYY'), 1200, 80),
    (1850, 'Mary Roberts', 1875, 20, TO_DATE('12-09-2008', 'DD-MM-YYYY'), 1170, 0),
    (1610, 'Sheldon Moris', 1175, 80, TO_DATE('08-05-2009', 'DD-MM-YYYY'), 11050, 915);


  SELECT * FROM CUSTOMER;


--1) SELECT TOP 3 CUSTOMER ID FROM THE SORTED TABLE
   SELECT CUS_ID FROM CUSTOMER LIMIT 3;
   
--2) CHANGE CUSTOMER NAME INTO UPPERCASE

	SELECT UPPER(cus_name) AS CUSTOMER_NAME
	 FROM CUSTOMER;

--3) LIST CUSTOMER NAME WHO PURVHASE THE PRODUCTID 80

 SELECT cus_name  FROM CUSTOMER
 WHERE PROD_ID=80;

-- 4) UPDATE CUSTOMER TABLE TO SET THE DEFAULT VALUE OF CUSTOMER NAME AS ABC

  UPDATE customer
   SET Cus_Name = 'ABC';

  SELECT * FROM CUSTOMER;
  
--5) LIST FIRST CUSTOMER ID WHOSE PRICE IS LESS THAN 20000
     SELECT CUS_ID, PRICE FROM CUSTOMER
	  WHERE PRICE<20000;

--6) LIST THE CUSTOMERS BELONGING TO THE PRODUCT ID 20
     SELECT * FROM CUSTOMER
	 WHERE PROD_ID=20;

--7) LIST THE ID AND NAME OF THE CUSTOMERS WHOSE PRODUCTS PRICE IS MORE THAN 4000
      SELECT CUS_ID, CUS_NAME, PRICE FROM CUSTOMER
	  WHERE PRICE>4000;
	 
--8) LIST THE CUSTOMER ID AND ID OF REFERENCE PERSON

      SELECT CUS_ID, REF_ID FROM CUSTOMER;

--9)LIST THE RECORDS IN THE ASCENDING ORDER OF CUSTOMER NAME

	 SELECT  CUS_NAME FROM CUSTOMER;
	  
     
--10) LIST THE NAME OF THE CUSTOMER WHO PURCHASE THEIR PRODUCT BEFORE 5-JUL-2009

	  SELECT CUS_NAME,DATE_OF_PURCHASE FROM CUSTOMER
	   WHERE DATE_OF_PURCHASE < '2009-07-05';
	   
--11) LIST THE NAME OF CUSTOMERS WHO DOES NOT REFER ANY PERSON

	   SELECT CUS_NAME FROM CUSTOMER
	   WHERE REF_ID=0;

	   
--12) LIST THE DIFFERENT PRODUCT ID AVAILABLE IN THE CUSTOMER TABLE

	 SELECT DISTINCT PROD_ID FROM CUSTOMER;

--13) LIST THE CUSTOMER NAME WHO  ARE NOT ELGIBLE FOR DISCOUNT

 SELECT CUS_NAME FROM CUSTOMER
 WHERE DISCOUNT=0;

--14) LIST THE ID OF THE CUSTOMERS HAVING "a" as seconds character of their name

 SELECT CUS_ID, CUS_NAME FROM CUSTOMER
  WHERE CUS_NAME LIKE '_a%';

--15) LIST THE CUSTOMER'S NAME, PRICE AND PROD_ID IN ASCENDING ORDER OF PROD_ID THEN ON DESCENDING ORDER  OF PRICE

SELECT cus_name, price, prod_id
FROM CUSTOMER
  ORDER BY price DESC;

--16) COUNT THE NO. OF DIFFERENT PRODUCTS_ID AVAILABLE IN THE CUSTOMER TABLE

SELECT COUNT(DISTINCT prod_id) AS total_distinct_products
FROM CUSTOMER;

--17) LIST THE TOTAL PRICE PAID BY THE CUSTOMERS

   SELECT SUM(PRICE) AS TOTAL_PRICE_PAID
    FROM CUSTOMER;

--18) LIST THE MAXIMUM PRICE OF PRODUCTS CATEGORIZED AS EQUIPMENT

 SELECT CUS_NAME, PRICE  AS EQUIPMENT FROM CUSTOMER
  ORDER BY price DESC LIMIT 1; 

--19) LIST THE MINIMUM PRICE OF PRODUCTS IN CUSTOMER TABLE

SELECT CUS_NAME, PRICE  AS EQUIPMENT FROM CUSTOMER
  ORDER BY price LIMIT 1; 
	
--20) LIST THE AVERAGE PRICE  AND THE NO. OF CUSTOMERS PURCHASING PRODUCTS HAVING ID 60.

  SELECT AVG(PRICE) AS AVG_PRICE, COUNT(DISTINCT CUS_NAME) AS TOTAL_CUS
   FROM CUSTOMER
   WHERE PROD_ID =60;


--21) LIST THE TOTAL PRICE, MAXIMUM, MINIMUM AND AVERAGE PRICE FOR PRODUCTS ID 20 AND 80.

    SELECT PROD_ID, SUM(price) ,
    MAX(price) ,
    MIN(price) ,
    AVG(price) 
FROM CUSTOMER
WHERE prod_id IN (20, 80) 
GROUP BY PROD_ID;

-------OR-------
SELECT 
    SUM(price) AS total_price,
    MAX(price) AS max_price,
    MIN(price) AS min_price,
    AVG(price) AS avg_price
FROM CUSTOMER
WHERE prod_id IN (20, 80)
GROUP BY PROD_ID;

--22) UPDATE THE DISCOUNT OF MARK LYON FROM 110 TO 100.

UPDATE CUSTOMER
SET discount = 100
WHERE cus_name = 'Mark Lyon' AND discount = 110;
 select * from customer;

--23) DELETE THE RECORD OF LUKE MARTIN.

DELETE FROM CUSTOMER
WHERE cus_name = 'Luke Martin';

--24) CHANGE THE DATA TYPE SIZE OF CUS_NAME

 ALTER TABLE CUSTOMER
 ALTER CUS_NAME TYPE VARCHAR(200);

--25)CREATE A COPY OF CUSTOMER TABLE AS NEW_CUSTOMER

   CREATE TABLE NEW_CUSTOMER AS
    SELECT * FROM CUSTOMER;

	
--26) REMOVE THE NEW_CUSTOMER TABLE WHILE MAINTAINING ITS STRUCTURE

     TRUNCATE NEW_CUSTOMER;

--27) REMOVE THE NEW_CUSTOMER TABLE COMPLETELY FROM THE DISK.

	DROP TABLE NEW_CUSTOMER;


             ----------------THANKYOU FOR READING---------------

   








































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































 





